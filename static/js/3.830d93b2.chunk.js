(window.webpackJsonp=window.webpackJsonp||[]).push([[3],[,,function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),o=a(13),i=a.n(o),c=(a(18),a(5)),u=a(6),l=a(10),s=a(8),f=a(11),v=(a(19),function(){return r.a.createElement("div",{className:"header",style:{backgroundColor:"#3f51b5",color:"#ffffff"}},"Ray Tracer")}),h=a(9),m=a.n(h),p=function(e){var t=e.sceneName,a=e.gamma,n=e.resolution,o=e.reflections,i=e.onParamChange,c=e.onStart,u=e.loading;return r.a.createElement("div",{className:"full",style:{backgroundColor:"#F5F5F5",position:"relative"}},r.a.createElement("div",{className:"content",style:{textAlign:"center"}},r.a.createElement("h2",null,"Rust + WebAssembly Path Tracer"),r.a.createElement("h3",null,"Author"),r.a.createElement("span",null,"Alessandro Genova"),r.a.createElement("h3",null,"Core Library"),r.a.createElement("span",null,r.a.createElement("a",{href:"https://github.com/alesgenova/ray-tracer",target:"_blank"},"Source"),r.a.createElement("br",null),"(rust)"),r.a.createElement("h3",null,"Demo App"),r.a.createElement("span",null,r.a.createElement("a",{href:"https://github.com/alesgenova/ray-tracer-app",target:"_blank"},"Source"),r.a.createElement("br",null),"(wasm, react)"),r.a.createElement("br",null),r.a.createElement("h3",null,"Scene"),r.a.createElement("select",{value:t,onChange:function(e){i("sceneName",e.target.value)}},r.a.createElement("option",{value:"random"},"Random"),r.a.createElement("option",{value:"room"},"Room")),r.a.createElement("h3",null,"Resolution"),r.a.createElement("select",{value:n,onChange:function(e){i("resolution",e.target.value)}},r.a.createElement("option",{value:10},"".concat(160," x ").concat(90)),r.a.createElement("option",{value:20},"".concat(320," x ").concat(180)),r.a.createElement("option",{value:40},"".concat(640," x ").concat(360)),r.a.createElement("option",{value:80},"".concat(1280," x ").concat(720))),r.a.createElement("h3",null,"Reflections"),r.a.createElement("select",{value:o,onChange:function(e){i("reflections",e.target.value)}},r.a.createElement("option",{value:2},"2"),r.a.createElement("option",{value:4},"4"),r.a.createElement("option",{value:8},"8"),r.a.createElement("option",{value:16},"16")),r.a.createElement("h3",null,"Gamma"),r.a.createElement("select",{value:a,onChange:function(e){i("gamma",e.target.value)}},r.a.createElement("option",{value:1},"1.0"),r.a.createElement("option",{value:1.5},"1.5"),r.a.createElement("option",{value:2},"2.0"),r.a.createElement("option",{value:2.5},"2.5"),r.a.createElement("option",{value:3},"3.0"))),r.a.createElement("div",{className:"floating-container-center"},r.a.createElement("button",{disabled:u,onClick:c,className:"floating-button-large",style:{backgroundColor:u?"#757de8":"#3f51b5",color:"#ffffff"}},r.a.createElement("ion-icon",{src:m.a}))))},d=a(20),g=a.n(d),y=a(21),w=a.n(y),_=a(3),b=function(e){var t=_.f.new();t.set_background([.25,.35,.45]);for(var a=0;a<20;++a)for(var n=0;n<20;++n){var r=.2+.2*Math.random(),o=a+Math.random()*(1-r);o=50*o/20-25;var i=n+Math.random()*(1-r);i=50*i/20-25;var c=void 0;if(Math.random()<.66666666)c=_.c.sphere(r),c=_.c.translation(c,[o,i,r]);else{var u=2*r*.75;c=_.c.cube(u,u,u),c=_.c.translation(c,[o,i,.75*r])}var l=[Math.random(),Math.random(),Math.random()],s=_.g.uniform(l),f=Math.random(),v=void 0;if(f<.3333)v=_.d.lambertian(s,.65);else if(f<.3333){var h=0+.2*Math.random();v=_.d.metal(s,h)}else{var m=1.2+1.2*Math.random();v=_.d.dielectric(s,m)}var p=_.a.new(c,v);t.add_actor(p)}var d=_.c.sphere(2);d=_.c.translation(d,[0,0,2]);var g=new Float64Array([.85,1,.85]),y=_.g.uniform(g),w=_.d.dielectric(y,2.4),b=_.a.new(d,w);t.add_actor(b);var k=_.c.sphere(2);k=_.c.translation(k,[0,-4.2,2]);var E=new Float64Array([.9,.9,.9]),j=_.g.uniform(E),O=_.d.metal(j,1e-5),x=_.a.new(k,O);t.add_actor(x);var C=_.c.sphere(2);C=_.c.translation(C,[0,4.2,2]);var M=new Float64Array([1,.25,.25]),A=_.g.uniform(M),N=_.d.metal(A,.05),D=_.a.new(C,N);t.add_actor(D);var F=_.c.sphere(4e3);F=_.c.translation(F,[0,0,-4e3]);var S=_.g.uniform([1,1,1]),I=_.g.uniform([.85,.85,.85]),R=_.g.checker(S,I),P=_.d.lambertian(R,.7),L=_.a.new(F,P);t.add_actor(L);var U=_.c.sphere(4);U=_.c.translation(U,[0,5,15.2]);var z=new Float64Array([1,1,1]),W=_.g.uniform(z),T=_.d.plain(W),q=_.a.new(U,T);t.add_actor(q);var B=_.b.new();return B.set_aspect(e),B.set_fov(.25*Math.PI),B.set_position(new Float64Array([-6,-10,2])),B.set_lookat(new Float64Array([0,0,2])),B.set_up(new Float64Array([0,0,1])),t.set_tree_type(2),{scene:t,camera:B}},k=function(e){var t=_.f.new(),a=_.c.rectangle(16,0,16,1);a=_.c.translation(a,[0,0,-4.5]);var n=_.g.uniform([1,1,1]),r=_.g.uniform([.8,.8,.8]),o=_.g.checker(n,r),i=_.d.lambertian(o,.75),c=_.a.new(a,i);t.add_actor(c);var u=_.c.rectangle(16,1,16,0);u=_.c.translation(u,[0,0,4.5]);var l=_.g.uniform([1,1,1]),s=_.d.lambertian(l,.75),f=_.a.new(u,s);t.add_actor(f);var v=_.c.rectangle(16,0,9,2);v=_.c.translation(v,[0,8,0]);var h=_.g.uniform([1,1,1]),m=_.d.lambertian(h,.75),p=_.a.new(v,m);t.add_actor(p);var d=_.c.rectangle(9,2,16,0);d=_.c.translation(d,[0,-8,0]);var g=_.g.uniform([1,1,1]),y=_.d.lambertian(g,.75),w=_.a.new(d,y);t.add_actor(w);var b=_.c.rectangle(16,1,9,2);b=_.c.translation(b,[-8,0,0]);var k=_.g.uniform([.2,1,.2]),E=_.d.lambertian(k,.75),j=_.a.new(b,E);t.add_actor(j);var O=_.c.rectangle(9,2,16,1);O=_.c.translation(O,[8,0,0]);var x=_.g.uniform([1,.2,.2]),C=_.d.lambertian(x,.75),M=_.a.new(O,C);t.add_actor(M);var A=_.c.cube(4,4,.5);A=_.c.translation(A,[0,4,4.5]);var N=_.g.uniform([1,1,1]),D=_.d.plain(N),F=_.a.new(A,D);t.add_actor(F);var S=_.c.sphere(2);S=_.c.translation(S,[-3.2,4,-2.5]);var I=_.g.uniform([.9,.9,.9]),R=_.d.metal(I,0),P=_.a.new(S,R);t.add_actor(P);var L=_.c.sphere(2);L=_.c.translation(L,[3.2,16/6,-2.5]);var U=_.g.uniform([1,1,1]),z=_.d.dielectric(U,2.4),W=_.a.new(L,z);t.add_actor(W);var T=_.b.new();return T.set_aspect(e),T.set_fov(.35*Math.PI),T.set_position([0,-7.84,0]),T.set_direction([0,1,0]),T.set_up([0,0,1]),t.set_tree_type(2),{scene:t,camera:T}};var E=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(s.a)(t).call(this,e))).computePixel=function(e){return new Promise(function(t){var n=new Float64Array(3),r=Math.floor(e/a.width),o=e%a.width;a.renderer.render_pixel(o,r,a.scene,a.camera,n),t({i:r,j:o,color:n})})},a.mainLoop=function(e,t){if(!(a.pause||t>a.maxIteration)){var n=a.renderer;t<0&&(n=a.previewRenderer);for(var r=new Float64Array(3),o=Math.min(a.width*a.height,e+a.chunkSize),i=e;i<o;++i){var c=Math.floor(i/a.width),u=i%a.width;n.render_pixel(u,c,a.scene,a.camera,r),a.updateImage(i,t,r)}a.updateCanvas(a.image);var l=o,s=t;o===a.width*a.height&&(l=0,s+=1),a.currentIndex=o,a.iteration=s,requestAnimationFrame(function(){a.mainLoop(l,s)})}},a.onPause=function(){var e=a.pause;a.pause=!e,e&&a.mainLoop(a.currentIndex,a.iteration),a.setState(function(t){return t.pause=!e,t})},a.onStop=function(){},a.state={pause:!1},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.width,a=e.height,n=e.sceneName,r=e.reflections;this.pause=!1,this.width=t,this.height=a;var o=function(e,t){return"random"===e?b(t):k(t)}(n,t/a),i=o.scene,c=o.camera;this.scene=i,this.camera=c,this.previewRenderer=_.e.new(t,a,0,0,!1),this.renderer=_.e.new(t,a,0,r,!1),this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.imageData=this.context.createImageData(this.width,this.height),this.imageElement.src=this.canvas.toDataURL(),this.image=new Float64Array(this.width*this.height*3),this.chunkSize=1e3,this.maxIteration=256,this.mainLoop(0,-1)}},{key:"componentDidUpdate",value:function(){this.context=this.canvas.getContext("2d"),this.imageData=this.context.createImageData(this.width,this.height)}},{key:"componentWillUnmount",value:function(){this.pause=!0}},{key:"updateImage",value:function(e,t,a){for(var n=1/((t=Math.max(0,t))+1),r=0;r<3;++r)this.image[3*e+r]=(1-n)*this.image[3*e+r]+n*a[r]}},{key:"updateCanvas",value:function(e){for(var t=1/this.props.gamma,a=0;a<this.width*this.height;++a)this.imageData.data[4*a]=255*Math.pow(e[3*a],t),this.imageData.data[4*a+1]=255*Math.pow(e[3*a+1],t),this.imageData.data[4*a+2]=255*Math.pow(e[3*a+2],t),this.imageData.data[4*a+3]=255;this.context.putImageData(this.imageData,0,0),this.imageElement.src=this.canvas.toDataURL()}},{key:"render",value:function(){var e=this,t=this.props.onStop,a=this.state.pause;return r.a.createElement("div",{className:"full",style:{position:"relative"}},r.a.createElement("div",{style:{width:"100%",maxWidth:"75rem",position:"absolute",left:"50%",top:"2rem",transform:"translateX(-50%)"}},r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("img",{style:{width:"100%"},ref:function(t){e.imageElement=t}}))),r.a.createElement("div",{className:"floating-container-center"},r.a.createElement("button",{onClick:this.onPause,className:"floating-button-large",style:{backgroundColor:"#757de8",color:"#ffffff",marginRight:"1rem"}},r.a.createElement("ion-icon",{src:a?m.a:w.a})),r.a.createElement("button",{onClick:t,className:"floating-button-large",style:{backgroundColor:"#9c27b0",color:"#ffffff"}},r.a.createElement("ion-icon",{src:g.a}))))}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(s.a)(t).call(this,e))).onStart=function(){a.setState(function(e){return e.loading=!1,e.loaded=!0,e})},a.onStop=function(){a.setState(function(e){return e.loading=!1,e.loaded=!1,e})},a.onParamChange=function(e,t){a.setState(function(a){return a[e]=t,a})},a.state={sceneName:"random",resolution:20,reflections:8,loading:!1,loaded:!1,gamma:2},a}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.sceneName,a=e.resolution,n=e.reflections,o=e.gamma,i=e.loaded,c=e.loading;return r.a.createElement("div",{className:"app"},r.a.createElement(v,null),r.a.createElement("div",{className:"content-container"},!i&&r.a.createElement(p,{sceneName:t,resolution:a,reflections:n,gamma:o,onParamChange:this.onParamChange,onStart:this.onStart,loading:c}),i&&r.a.createElement(E,{sceneName:t,width:16*a,height:9*a,reflections:n,gamma:o,onStop:this.onStop})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},function(e,t,a){"use strict";a.d(t,"l",function(){return g}),a.d(t,"h",function(){return w}),a.d(t,"o",function(){return _}),a.d(t,"i",function(){return b}),a.d(t,"k",function(){return k}),a.d(t,"j",function(){return j}),a.d(t,"n",function(){return O}),a.d(t,"m",function(){return x}),a.d(t,"r",function(){return C}),a.d(t,"p",function(){return M}),a.d(t,"q",function(){return A}),a.d(t,"c",function(){return N}),a.d(t,"b",function(){return D}),a.d(t,"a",function(){return F}),a.d(t,"e",function(){return S}),a.d(t,"f",function(){return I}),a.d(t,"g",function(){return R}),a.d(t,"d",function(){return P}),a.d(t,"s",function(){return L});var n=a(5),r=a(6),o=a(22),i=null;function c(){return null!==i&&i.buffer===o.z.buffer||(i=new Float64Array(o.z.buffer)),i}var u=0;function l(e){var t=o.i(8*e.length);return c().set(e,t/8),u=e.length,t}var s=new TextDecoder("utf-8"),f=null;function v(){return null!==f&&f.buffer===o.z.buffer||(f=new Uint8Array(o.z.buffer)),f}function h(e,t){return s.decode(v().subarray(e,e+t))}var m=new Array(32);m.fill(void 0),m.push(void 0,null,!0,!1);var p=m.length;function d(e){p===m.length&&m.push(m.length+1);var t=p;return p=m[t],m[t]=e,t}function g(e,t){var a=h(e,t);return d(new Function(a))}function y(e){return m[e]}function w(e,t){return d(y(e).call(y(t)))}function _(e){return d(y(e).self)}function b(e){return d(y(e).crypto)}function k(e){return d(y(e).getRandomValues)}function E(e,t){return v().subarray(e/1,e/1+t)}function j(e,t,a){var n=E(t,a);y(e).getRandomValues(n)}function O(e,t){var n=h(e,t);return d(a(23)(n))}function x(e,t,a){var n=E(t,a);y(e).randomFillSync(n)}function C(e){var t;(t=e)<36||(m[t]=p,p=t)}function M(e){return void 0===y(e)?1:0}function A(e,t){return y(e)===y(t)?1:0}var N=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.c(e)}(e)}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"sphere",value:function(t){return e.__wrap(o.t(t))}},{key:"cube",value:function(t,a,n){return e.__wrap(o.r(t,a,n))}},{key:"rectangle",value:function(t,a,n,r){return e.__wrap(o.s(t,a,n,r))}},{key:"translation",value:function(t,a){var n=t.ptr;t.ptr=0;var r=l(a),i=u;try{return e.__wrap(o.u(n,r,i))}finally{o.h(r,8*i)}}}]),e}();var D=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.b(e)}(e)}},{key:"set_aspect",value:function(e){return o.l(this.ptr,e)}},{key:"set_fov",value:function(e){return o.n(this.ptr,e)}},{key:"set_position",value:function(e){var t=l(e),a=u;try{return o.p(this.ptr,t,a)}finally{o.h(t,8*a)}}},{key:"set_direction",value:function(e){var t=l(e),a=u;try{return o.m(this.ptr,t,a)}finally{o.h(t,8*a)}}},{key:"set_lookat",value:function(e){var t=l(e),a=u;try{return o.o(this.ptr,t,a)}finally{o.h(t,8*a)}}},{key:"set_up",value:function(e){var t=l(e),a=u;try{return o.q(this.ptr,t,a)}finally{o.h(t,8*a)}}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"new",value:function(){return e.__wrap(o.k())}}]),e}();var F=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.a(e)}(e)}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"new",value:function(t,a){var n=t.ptr;t.ptr=0;var r=a.ptr;return a.ptr=0,e.__wrap(o.j(n,r))}}]),e}();var S=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.e(e)}(e)}},{key:"render",value:function(e,t,a){var n=l(a),r=u;try{return o.B(this.ptr,e.ptr,t.ptr,n,r)}finally{a.set(c().subarray(n/8,n/8+r)),o.h(n,8*r)}}},{key:"render_pixel",value:function(e,t,a,n,r){var i=l(r),s=u;try{return o.C(this.ptr,e,t,a.ptr,n.ptr,i,s)}finally{r.set(c().subarray(i/8,i/8+s)),o.h(i,8*s)}}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"new",value:function(t,a,n,r,i){return e.__wrap(o.A(t,a,n,r,i))}}]),e}();var I=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.f(e)}(e)}},{key:"add_actor",value:function(e){var t=e.ptr;return e.ptr=0,o.D(this.ptr,t)}},{key:"set_background",value:function(e){var t=l(e),a=u;try{return o.F(this.ptr,t,a)}finally{o.h(t,8*a)}}},{key:"set_tree_type",value:function(e){return o.G(this.ptr,e)}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"new",value:function(){return e.__wrap(o.E())}}]),e}();var R=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.g(e)}(e)}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"uniform",value:function(t){var a=l(t),n=u;try{return e.__wrap(o.I(a,n))}finally{o.h(a,8*n)}}},{key:"checker",value:function(t,a){var n=t.ptr;t.ptr=0;var r=a.ptr;return a.ptr=0,e.__wrap(o.H(n,r))}}]),e}();var P=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"free",value:function(){var e=this.ptr;this.ptr=0,function(e){o.d(e)}(e)}}],[{key:"__wrap",value:function(t){var a=Object.create(e.prototype);return a.ptr=t,a}},{key:"plain",value:function(t){var a=t.ptr;return t.ptr=0,e.__wrap(o.y(a))}},{key:"lambertian",value:function(t,a){var n=t.ptr;return t.ptr=0,e.__wrap(o.w(n,a))}},{key:"metal",value:function(t,a){var n=t.ptr;return t.ptr=0,e.__wrap(o.x(n,a))}},{key:"dielectric",value:function(t,a){var n=t.ptr;return t.ptr=0,e.__wrap(o.v(n,a))}}]),e}();function L(e,t){throw new Error(h(e,t))}},,,,,,function(e,t,a){e.exports=a.p+"static/media/play.7674a1b6.svg"},,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/stop.292a58fa.svg"},function(e,t,a){e.exports=a.p+"static/media/pause.ec5c6800.svg"},function(e,t,a){"use strict";var n=a.w[e.i];e.exports=n;a(3);n.J()},function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=23}]]);
//# sourceMappingURL=3.830d93b2.chunk.js.map